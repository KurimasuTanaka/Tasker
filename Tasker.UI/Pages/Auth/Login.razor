@page "/login"

@attribute [AllowAnonymous]

@inject IAuthServiceUI _authServiceUI;
@inject NavigationManager _navigation

<MudPaper Elevation="3" Outlined="true" Class="pa-10 ma-2">
    <MudText Typo="Typo.h4">Login</MudText>

    <MudForm Model="loginModel">
        <MudTextField Variant="Variant.Outlined" HelperText="Email"  Required="true" @bind-Value="loginModel.Email" />
        <MudTextField Variant="Variant.Outlined" HelperText="Password" Required="true" type="password"
            @bind-Value="loginModel.Password" />
        @if (!string.IsNullOrEmpty(errorMessage))
        {
            <MudText Color="Color.Error">@errorMessage</MudText>
        }
        <MudButton Variant="Variant.Filled" Color="Color.Primary" @onclick="HandleLogin">Login</MudButton>
    </MudForm>
</MudPaper>

@code {
    LoginModel loginModel = new LoginModel();

    string errorMessage = string.Empty;

    async Task HandleLogin()
    {
        string result = await _authServiceUI.Login(loginModel);
        if (result == "Authorized successfully") _navigation.NavigateTo("/");
        else errorMessage = result;
    }
}