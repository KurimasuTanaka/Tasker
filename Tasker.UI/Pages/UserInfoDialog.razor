@using System.Security.Claims
@inject IUsersManager _usersManager
@inject AuthenticationStateProvider _authenticationStateProvider

<MudDialog>
    <TitleContent>
        User info
    </TitleContent>
    <DialogContent>
        <MudText Typo="Typo.h6">First Name: @user?.FirstName</MudText>
        <MudText Typo="Typo.h6">Last Name: @user?.LastName</MudText>
        <MudText Typo="Typo.h6">ID: @user?.UserIdentity</MudText>
    </DialogContent>
</MudDialog>

@code {
    [CascadingParameter]
    public IMudDialogInstance MudDialog { get; set; } = default!;
    public User user = default!;

    protected override async Task OnInitializedAsync()
    {
        var authState = await _authenticationStateProvider.GetAuthenticationStateAsync();
        string? userId = authState.User.FindFirst(c => c.Type == ClaimTypes.NameIdentifier)?.Value;
        if (userId is null) 
        {
            MudDialog.Close();
            return;
        }
        user = await _usersManager.GetUserById(userId);
    }
}